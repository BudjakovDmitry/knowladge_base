# Docker-compose

Docker-compose позволяет запускать проект, который состоит из нескольких контейнеров.

Инструкции о том, как запускать многоконтейнерный проект описываются в файле docker-compose.yml. При запуске docker-compose создает сеть между контейнерами и дает им возможность общаться друг с другом по именам.

Пример файла docker-compose.yml

```docker-compose
version: '2'
services:
  nginx:
    image: nginx:latest
    ports:
      - "8000:80"
    volumes:
      - ./hosts:/etc/nginx/conf.d
      - ./www:/var/www
      - ./logs:/var/log/nginx
    links:
      -php
  php:
    build: ./images/php
    volumes:
      - ./www:/var/www
```

version - версия compose. Сейчас существует 3 версии. Версия 1 уже не используется. Версии 2 еще встречается. Самая последняя - это версия 3.

services содержит контейнеры, которые необходимо запустить для проекта. В примере нужно запустить два сервиса: nginx и php. По названием сервисов docker-compose сделает сетевое взаимодействие и возможность образаться к контейнерам по именам.

image содержит название образа, из которого должен создаться контейнер.

ports указывает какие порты нужно открыть (на хосте открывается порт 8000 и пробрасывается на 80 порт в контейнере).

volumes указывают, какие папки нужно пробросить с хоста внутрь контейнера.

build указывает папку, из которой нужно собрать образ. Команда image будет искать готовый образ и при необходимости скачает его, а build будет собирать образ из локальной папки.

## Команды

`docker-compose build` - собрать проект

`docker-compose up` - запустить проект

При выполнении этой команды docker-compose будет искать файл docker-compose.yml в текущей директории.

-d - запустить в режиме демона.

-f - указать явно, какой docker-compose.yml файл использовать для запуска проекта.

`docker-compose down` - остановить проект

`docker-compose logs -f [service name]` - посмотреть логи сервиса

`docker-compose ps` - вывести список контейнеров

`docker-compose exec [service-name] [command]` - выполнить команду

`docker-compose images` - список образов
