# Команды docker

`docker build <</path/to/dir>>` - собрать образ

/path/to/dir - директория, из которой нужно собрать образ docker. Чтобы собрать образ из текущей директории ставим точку `.`.

Необходимо, чтобы в указанной директории находился Dockerfile, из которого будет собран образ.

```bash
docker build -t hello_world
```

-t - задать имя образа
---

`docker images` - показывает список образов, которые имеются локально на хосте.

-q вывести только ID всех образов

---

`docker logs <<name>>` - логи контейнера

---

`docker ps` - показывает список контейнеров, запущенных локально на хосте.

-a если добавить этот ключ, то будут показаны все контейнеры: запущенные и остановленные.

В столбце STATUS можно увидеть, с каким статусом завершил работу контейнер. Это будет статус главного процесса в контейнера (процесс с PID=1).

-q выдются только id контейнеров

---

`docker pull <<name>>` - скачать образ из registry на машину

`docker rm <<name>>` - удалить контейнер

```bash
docker rm elited_wiles
```

Пример, как можно удалить все контейнеры:

```bash
docker rm $(docker ps -a -q)
```

---

`docker run <<name>>` - запустить контейнер

```bash
docker run nginx
```

Философия docker заключается в том, что образы нужно создавать так, чтобы в одном контейнере был один процесс. Это должен быть процесс той программы, ради которой создается контейнер. Этому процессу присваивается PID 1. Когда процесс с PID 1 завершится, контейнер будет остановлен.

-d говорит, что программу нужно запустить в режиме демона. Когда мы запускаем контейнер, по умолчанию терминал "проваливается" внутрь контейнера и пока контейнер работает данный терминал будет заблокирован. В режиме демона контейнер запустится и отдаст терминал.

--name задает имя контейнеру `docker run --name my_container_name image`. Если не задавать имя контейнеру, docker присвоит его сам.

--rm говорит о том, что когда контейнер остановится, его нужно удалить.

-p на каком порту будет работать приложение; `-p 80:80`; первым указывается порт на хосте, а вторым указывается, на какой порт в контейнере нужно пробросить.
---

`docker search <<name>>` - поиск образа в registry. Эта команда будет искать в dockerhub пакеты, названия которых совпадают с тем, что мы ищем

```bash
docker search nginx
```

---

`docker start/restart <<name>>` - работа с контейнером

---

`docker stop <<name>>` - остановить контейнер

---

`docker inspect <<container_name>>` - выдает параметры и настройки, с которыми был запущен контейнер.

Настройки сети лежат в разделе NetworkSettings. Там можно посмотреть IP адрес контейнера, порт, который открыт в контейнере и т.п.

---

`docker exec [options] container_name command` служит для передачи команд внутрь контейнера.

Например, чтобы попасть внутрь оболочки контейнера, нужно исполнить bash внутри контейнера. Чтобы подключиться в интерактивном режиме нужно добавить два ключа: `-it`.

```bash
docker exec -it nginx /bin/bash
```
