# Схемы

Схема - это логический фрагмент БД, в котором могут содержаться различные объекты: таблицы, представления, индексы и др. В БД обязательно есть хотя бы одна схема. При создании БД в ней автоматически создается схема с именем `public`.

В каждой БД может содержаться более одной схемы. Имена схем должны быть уникальными в пределах конкретной базы данных. Имена объектов базы данных (таблицы, представления, индексы и др.) должны быть уникальными в пределах схемы, но в разных схемах имена могут повторяться. Таким образом, можно сказать, что схема образует пространство имен.

Посмотреть список схем

```
\dn
```

Если в БД создано более одной схемы, то доступ к объектам, содержащимся в конкретной схеме, можно организовать разными способами. Первый заключается в том, чтобы имена объектов предварять именем схемы.

```sql
SELECT * FROM schema_name.table_name;
```

Другой способ заключается в том, чтобы одну из схем сделать текущей.

Среди параметров времени исполнения, предусмотренных конфигурацией сервера PostgreSQL, есть параметр search_path. Его значение по умолчанию можно изменить в конфигурационном файле postgresql.conf. Он содержит имена схем, которые PostgreSQL просматривает при поиске конкретного объекта базы данных, когда имя схемы в команде не указано. Посмотреть значение этого параметра можно с помощью команды SHOW.

```sql
SHOW search_path;

   search_path
-----------------
 "$user", public
```

Схема "$user" присутствует в этом параметре на тот случай, если будут созданы схемы с именами, совпадающими с именами пользователей. Тогда могут опроститься некоторые операции с БД. Если в БД нет таких схем, то этот элемент фактически не участвует в работе. В результате в нашем примере все обращения к объектам БД без указания имени схемы будут адресовываться схеме public.

Чтобы изменить порядок просмота схем при поиске объектов в БД, нужно воспользоваться командой `SET`. Первой в списке следует указать именно ту схему, которую СУБД должна просматривать первой. Эта схема и станет текущей. Список схем может состоять всего из одной схемы.

```sql
SET search_path = my_schema;
```

или

```sql
SET search_path TO my_schema;
```

Теперь схема my_schema стала текущей. Для обращения к объектам в схеме public теперь нужно указывать имя схемы перед именами объектов.

Если хотим добавить схему public в список просматриваемых схем, то включить ее в команду SET.

```sql
SET search_path = my_schema, public;
```

Узнать имя текущей схемы можно с помощтю встроенной функции `current_schema`

```sql
SELECT current_schema;
```

При создании объектов баз данных необходимо учитывать: если имя схемы в команде не указано, то объект будет создан в текущей схеме. Если объект необъодимо создать в схеме, отличной от текущей, то необходимо указать ее имя перед именем создаваемого объекта, разделив их точкой.

```sql
CREATE TABLE my_schema.airports
...
```
