# Переменные и присваивание

В Python не трубуется определять переменные заранее. Переменная создается в тот момент, когда ей присваивается значение, при этом переменной можно присвоить значение любого типа. Переменная не располагает информацией о типе. Понятие типа живет в объекте. Переменная же просто ссылается на определенный объект в конкретный момент времени. Такая модель поведения называется *динамической типизацией*.

При использовании внутри выражения имя переменной замещается объектом, на который в текущий момент ссылается.

Прежде чем появится возможность обратиться к переменной, ей должно быть присвоено какое-то значение. В противном случае произойдет ошибка.

Когда переменной присваивается значение: `a = 3`, концептуально происходит три отдельных шага, чтобы выполнить инструкцию:

1. Создание объекта для представления значения 3

   В целях оптимизации Python внутренне кеширует и повторно исползует определенные виды неизменяемых объектов, такие как небольшие целые числа и строки.

2. Создание переменной *a*, если она еще не существует
3. Связывание переменной *a* с новым объектом 3.

В итоге переменная *a* становится *ссылкой* на объект *3*. Внутренне переменная представляет собой указатель на область памяти объекта, созданного в результате выполнения литерального выражения *3*. Переменные всегда ссылаются на объекты и никогда на другие переменные, но более крупные объекты могут быть связаны с другими объектами (например, объект списка содержит ссылки на содержащиеся в нем объекты).

Более формальная терминология:

* переменные - это записи в системной таблице, в которых предусмотрены места для связей с объектами;
* объекты - это области выделенной памяти с достаточным пространством для представления значений, для которых они предназначены;
* ссылки - это следуемые указатели от переменных к объектам;

Помимо пространства, предназначенного для представления значений, каждый объект содержит два стандартных заголовочных поля: *обозначение типа*, применяемое для пометки типа объекта и *счетчик ссылок*, используемый для определения, когда можно освободить память, которую занимает объект.

## Разделяемые ссылки

Рассмотрим пример

```python
a = 3
b = a
```

Во втором выражении Python создаст переменную b. Переменная a в этом выражении используется, поэтому она заменяется объектом, на который ссылается. В b начинает храниться сслка на объект 3. В итоге переменные a и b начинают ссылаться на один и тот же объект.

Когда множество переменных ссылаются на один и тот же объект, это называют *разделяемой ссылкой* (или *разделяемым объектом*).

Расширим пример

```python
a = 3
b = a
a = 'spam'
```

Последний оператор создает объект для представленяи стрки spam. Переменная *a* теперь ссылается на этот созданный объект. Однако это не изменит значение *b*: она по прежнему будет ссылаться на целочислнный объект *3*.

Еще пример

```python
a = 3
b = a
a = a + 2
```

Не существует способа переписать значение объекта 3, поскольку целые числа неизменяемы. Последнее присваивание приравнивает *a* в новый объект 5. Поэтому манипуляции с переменной a никак не повлияют на переменную b. Однако это справедливо только в случае неизменяемых объектов.
